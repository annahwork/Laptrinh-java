<link rel="stylesheet" href="../../assets/css/EVM-Staff/allocate_parts.css">
<section class="allocate-parts-page">
    <div class="content-wrapper" id="innerContent">
        <div class="main-content-area">

            <!-- TÌM KIẾM -->
            <div class="search-filter-bar">
                <div class="search-box-wrapper">
                    <div class="search-input-wrapper">
                        <input type="text" id="searchPart" class="search-input" placeholder="Tìm mã, tên hoặc loại phụ tùng...">
                        <svg class="search-icon" viewBox="0 0 20 20" fill="none"><path d="M8.5 3.5a5 5 0 100 10 5 5 0 000-10zm-7 5a7 7 0 1112.67 4.15l3.68 3.68a1 1 0 01-1.42 1.42l-3.68-3.68A7 7 0 011.5 8.5z" stroke="currentColor" stroke-width="1.5"/></svg>
                    </div>
                    <button class="search-btn">
                        <svg viewBox="0 0 20 20" fill="currentColor"><path d="M8.5 3.5a5 5 0 100 10 5 5 0 000-10zm-7 5a7 7 0 1112.67 4.15l3.68 3.68a1 1 0 01-1.42 1.42l-3.68-3.68A7 7 0 011.5 8.5z" stroke="currentColor" stroke-width="1.5"/></svg>
                        Tìm
                    </button>
                </div>
                <div class="filter-wrapper">
                    <select id="filterCategory" class="filter-select">
                        <option value="">Tất cả loại phụ tùng</option>
                        <option value="engine">Động cơ</option>
                        <option value="brake">Phanh</option>
                        <option value="suspension">Hệ thống treo</option>
                        <option value="electrical">Điện tử</option>
                    </select>
                </div>
            </div>

            <!-- DANH SÁCH PHỤ TÙNG -->
            <div class="parts-list-section">
                <div class="section-header parts-list-section__header">
                    <div class="parts-list-section__title-group">
                        <h2 class="parts-list-section__title">Danh sách phụ tùng khả dụng</h2>
                    </div>

                    <div class="parts-list-section__actions">
                        <button class="btn btn-refresh" id="refreshPartsList">
                            <!-- svg ngắn gọn -->
                            Làm mới
                        </button>

                        <button class="btn btn-allocate" id="openAllocateModal">
                            Phân bổ phụ tùng
                        </button>
                    </div>
                </div>

                <!-- bảng phụ tùng -->
                <table class="parts-table">
                    <thead>
                    <tr>
                        <th class="text-center">Mã phụ tùng</th>
                        <th class="text-center">Tên phụ tùng</th>
                        <th class="text-center">Loại</th>
                        <th class="text-center">Số lượng tồn</th>
                        <th class="text-center">Vị trí kho</th>
                    </tr>
                    </thead>

                    <tbody id="partsTableBody">
                    <!-- chỉ hiển thị tối đa 2 phụ tùng -->
                    <tr>
                        <td class="text-center">PT-001</td>
                        <td class="text-center">Bộ lọc dầu</td>
                        <td class="text-center">Động cơ</td>
                        <td class="text-center">25</td>
                        <td class="text-center">K1-R2</td>
                    </tr>
                    <tr>
                        <td class="text-center">PT-002</td>
                        <td class="text-center">Bình ắc quy</td>
                        <td class="text-center">Điện tử</td>
                        <td class="text-center">8</td>
                        <td class="text-center">K2-R1</td>
                    </tr>

                    <!-- hàng "Xem thêm" (giữ lại nhưng có id để JS điều khiển) -->
                    <tr class="parts-more-row" style="display: none;">
                        <td colspan="5" class="no-data">
                            <button id="partsViewMoreBtn" class="btn btn-view-more">
                                Xem thêm phụ tùng khác →
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- LỊCH SỬ PHÂN BỔ -->
            <div class="allocation-history-section">
                <div class="section-header">
                    <h2>Lịch sử phân bổ gần đây</h2>
                    <p>Theo dõi các đợt chuyển kho gần nhất</p>
                </div>

                <table class="history-table">
                    <thead>
                    <tr>
                        <th>Mã phân bổ</th>
                        <th>Ngày</th>
                        <th>Trung tâm nhận</th>
                        <th>Số lượng</th>
                        <th>Người thực hiện</th>
                    </tr>
                    </thead>
                    <tbody id="allocationHistoryBody">
                    <tr>
                        <td>ALLOC-20251103-01</td>
                        <td>03/11/2025</td>
                        <td>SC001 - Trung tâm TP.HCM</td>
                        <td>10</td>
                        <td>Nguyễn Văn A</td>
                    </tr>
                    <tr>
                        <td>ALLOC-20251104-02</td>
                        <td>04/11/2025</td>
                        <td>SC002 - Trung tâm Hà Nội</td>
                        <td>5</td>
                        <td>Trần Thị B</td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- MODAL PHÂN BỔ -->
            <div class="modal" id="allocateModal" style="display: none;">
                <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="allocateModalTitle">
                    <div class="modal-header">
                        <h3 id="allocateModalTitle">Phân bổ phụ tùng</h3>
                        <!-- nút đóng header (id khác) và class chung -->
                        <button type="button" class="modal-close-btn" id="closeAllocateModalHeader" aria-label="Đóng modal">×</button>
                    </div>

                    <form id="allocateForm">
                        <div class="form-group">
                            <label for="scCenterSelect">Trung tâm nhận</label>
                            <select id="scCenterSelect" required>
                                <option value="">-- Chọn trung tâm --</option>
                                <option value="SC001">SC001 - Trung tâm TP.HCM</option>
                                <option value="SC002">SC002 - Trung tâm Hà Nội</option>
                                <option value="SC003">SC003 - Trung tâm Đà Nẵng</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="quantity">Số lượng phân bổ</label>
                            <input type="number" id="quantity" min="1" required placeholder="Nhập số lượng">
                        </div>

                        <div class="form-footer">
                            <button type="submit" class="btn btn-confirm">Xác nhận</button>
                            <!-- nút Hủy footer: class chung để đóng -->
                            <button type="button" class="btn btn-cancel modal-close-btn" id="cancelAllocateModal">Hủy</button>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    </div>
</section>